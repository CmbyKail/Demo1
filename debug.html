<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯Šæ–­é¡µé¢ - æƒ…å•†è®­ç»ƒè¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ddd;
        }
        .test-item.pass { border-left-color: #4CAF50; }
        .test-item.fail { border-left-color: #f44336; }
        .test-item.warn { border-left-color: #ff9800; }
        h2 { color: #333; }
        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover { background: #5568d3; }
    </style>
</head>
<body>
    <h1>ğŸ” æƒ…å•†è®­ç»ƒè¥ - è¯Šæ–­å·¥å…·</h1>

    <div id="results"></div>

    <script>
        const results = document.getElementById('results');

        function addTest(name, passed, message) {
            const div = document.createElement('div');
            div.className = `test-item ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <strong>${passed ? 'âœ…' : 'âŒ'} ${name}</strong>
                <p>${message}</p>
            `;
            results.appendChild(div);
        }

        function runTests() {
            results.innerHTML = '<h2>è¯Šæ–­ç»“æœ:</h2>';

            // æµ‹è¯• 1: æ£€æŸ¥æŠ€èƒ½æŒ‰é’®
            const skillsBtn = document.getElementById('skills-training-btn');
            if (skillsBtn) {
                addTest('æŠ€èƒ½æŒ‰é’®å­˜åœ¨', true, `æŒ‰é’®å…ƒç´ å·²æ‰¾åˆ°: <code>${skillsBtn.outerHTML.substring(0, 100)}...</code>`);
            } else {
                addTest('æŠ€èƒ½æŒ‰é’®å­˜åœ¨', false, 'åœ¨ index.html ä¸­æ‰¾ä¸åˆ° id="skills-training-btn" çš„å…ƒç´ ');
            }

            // æµ‹è¯• 2: æ£€æŸ¥æŠ€èƒ½è§†å›¾
            const skillsView = document.getElementById('skills-view');
            if (skillsView) {
                addTest('æŠ€èƒ½è§†å›¾å­˜åœ¨', true, 'æŠ€èƒ½è§†å›¾ section å·²æ‰¾åˆ°');
            } else {
                addTest('æŠ€èƒ½è§†å›¾å­˜åœ¨', false, 'åœ¨ index.html ä¸­æ‰¾ä¸åˆ° id="skills-view" çš„å…ƒç´ ');
            }

            // æµ‹è¯• 3: æ£€æŸ¥ JS æ–‡ä»¶å¼•å…¥
            const scripts = Array.from(document.querySelectorAll('script'));
            const skillScripts = scripts.filter(s =>
                s.src && s.src.includes('modules/skills')
            );

            if (skillScripts.length > 0) {
                addTest('æŠ€èƒ½æ¨¡å—JSå¼•å…¥', true, `æ‰¾åˆ° ${skillScripts.length} ä¸ªæŠ€èƒ½æ¨¡å—è„šæœ¬:
                    <br>${skillScripts.map(s => `<code>${s.src.split('/').pop()}</code>`).join(', ')}`);
            } else {
                addTest('æŠ€èƒ½æ¨¡å—JSå¼•å…¥', false, 'æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æŠ€èƒ½æ¨¡å—çš„è„šæœ¬å¼•å…¥');
            }

            // æµ‹è¯• 4: æ£€æŸ¥ app.js ç‰ˆæœ¬
            const appScript = scripts.find(s => s.src && s.src.includes('app.js'));
            if (appScript) {
                const hasVersion = appScript.src.includes('?v=');
                addTest('app.jsç‰ˆæœ¬æ§åˆ¶', hasVersion,
                    hasVersion
                        ? `å½“å‰ç‰ˆæœ¬: <code>${appScript.src}</code>`
                        : 'app.js æ²¡æœ‰ç‰ˆæœ¬å·ï¼Œå¯èƒ½è¢«ç¼“å­˜');
            } else {
                addTest('app.jså¼•å…¥', false, 'æ‰¾ä¸åˆ° app.js');
            }

            // æµ‹è¯• 5: æ£€æŸ¥æ¨¡å—å®¹å™¨
            const container = document.getElementById('skills-modules-container');
            if (container) {
                addTest('æŠ€èƒ½æ¨¡å—å®¹å™¨', true, 'å®¹å™¨å…ƒç´ å·²æ‰¾åˆ°');
            } else {
                addTest('æŠ€èƒ½æ¨¡å—å®¹å™¨', false, 'æ‰¾ä¸åˆ° id="skills-modules-container" çš„å®¹å™¨');
            }

            // æµ‹è¯• 6: æµ‹è¯• fetch
            addTest('ç½‘ç»œè¯·æ±‚æµ‹è¯•', true, 'å°è¯•åŠ è½½ server_data.json...');
            fetch('/server_data.json')
                .then(r => r.json())
                .then(data => {
                    const hasModules = data.skillModules && Object.keys(data.skillModules).length > 0;
                    if (hasModules) {
                        addTest('æŠ€èƒ½æ¨¡å—æ•°æ®', true, `æ‰¾åˆ° ${Object.keys(data.skillModules).length} ä¸ªæ¨¡å—:
                            <br>${Object.keys(data.skillModules).map(k => `<code>${k}</code>`).join(', ')}`);
                    } else {
                        addTest('æŠ€èƒ½æ¨¡å—æ•°æ®', false, 'server_data.json ä¸­æ²¡æœ‰ skillModules æ•°æ®');
                    }
                })
                .catch(err => {
                    addTest('æŠ€èƒ½æ¨¡å—æ•°æ®', false, `æ— æ³•åŠ è½½ server_data.json: ${err.message}`);
                });
        }

        // é¡µé¢åŠ è½½åè¿è¡Œæµ‹è¯•
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(runTests, 100);
        });

        // æ·»åŠ æ‰‹åŠ¨åˆ·æ–°æŒ‰é’®
        const btn = document.createElement('button');
        btn.textContent = 'ğŸ”„ é‡æ–°è¿è¡Œè¯Šæ–­';
        btn.onclick = runTests;
        results.appendChild(btn);
    </script>
</body>
</html>
